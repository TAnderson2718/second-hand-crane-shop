"use strict";(wx["webpackJsonp"]=wx["webpackJsonp"]||[]).push([[881],{3637:function(e,n,r){var a=r(2180),s=r(8118),t=r(5308),i=r(7042),l=r(4460),c=r(597),o=r(1867),h=r(5023),u=r(201),d=r(1515),m=r(2954),f=r.n(m),x=r(302),g=r(1876),v=r(2269),p=function(e){function n(){var e;(0,i.Z)(this,n);for(var r=arguments.length,a=new Array(r),l=0;l<r;l++)a[l]=arguments[l];return e=(0,c.Z)(this,n,[].concat(a)),(0,h.Z)(e,"state",{favorites:[],loading:!0,error:null}),(0,h.Z)(e,"loadFavorites",(0,t.Z)((0,s.Z)().m(function n(){var r;return(0,s.Z)().w(function(n){while(1)switch(n.n){case 0:try{e.setState({loading:!0,error:null}),r=(0,x._l)(),e.setState({favorites:r,loading:!1})}catch(n){console.error("\u52a0\u8f7d\u6536\u85cf\u5217\u8868\u5931\u8d25:",n),e.setState({error:"\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5",loading:!1}),(0,g.CF)("\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5","error")}case 1:return n.a(2)}},n)}))),(0,h.Z)(e,"handleRemoveFavorite",function(){var n=(0,t.Z)((0,s.Z)().m(function n(r){return(0,s.Z)().w(function(n){while(1)switch(n.n){case 0:if(r){n.n=1;break}return n.a(2);case 1:try{(0,x.zm)(r),(0,g.CF)("\u5df2\u53d6\u6d88\u6536\u85cf"),e.loadFavorites()}catch(e){console.error("\u53d6\u6d88\u6536\u85cf\u5931\u8d25:",e),(0,g.CF)("\u64cd\u4f5c\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5","error")}case 2:return n.a(2)}},n)}));return function(e){return n.apply(this,arguments)}}()),(0,h.Z)(e,"handleCall",function(){var e=(0,t.Z)((0,s.Z)().m(function e(n){var r;return(0,s.Z)().w(function(e){while(1)switch(e.p=e.n){case 0:if(n){e.n=1;break}return(0,g.CF)("\u8054\u7cfb\u7535\u8bdd\u4e0d\u53ef\u7528","error"),e.a(2);case 1:return e.p=1,e.n=2,(0,g.Pt)(n);case 2:e.n=4;break;case 3:e.p=3,r=e.v,console.error("\u62e8\u6253\u7535\u8bdd\u5931\u8d25:",r),(0,g.CF)("\u62e8\u6253\u7535\u8bdd\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5","error");case 4:return e.a(2)}},e,null,[[1,3]])}));return function(n){return e.apply(this,arguments)}}()),(0,h.Z)(e,"goToDetail",function(e){if(e)try{(0,g.T8)("/pages/detail/detail?id=".concat(e))}catch(e){console.error("\u9875\u9762\u8df3\u8f6c\u5931\u8d25:",e),(0,g.CF)("\u9875\u9762\u8df3\u8f6c\u5931\u8d25","error")}}),(0,h.Z)(e,"onPullDownRefresh",function(){e.loadFavorites().finally(function(){f().stopPullDownRefresh()})}),e}return(0,o.Z)(n,e),(0,l.Z)(n,[{key:"componentDidMount",value:function(){this.loadFavorites()}},{key:"componentDidShow",value:function(){this.loadFavorites()}},{key:"render",value:function(){var e=this,n=this.state,r=n.favorites,a=n.loading,s=n.error;return a?(0,v.jsx)(d.G7,{className:"favorites",children:(0,v.jsx)(d.G7,{className:"loading-container",children:(0,v.jsx)(d.xv,{children:"\u52a0\u8f7d\u4e2d..."})})}):s?(0,v.jsx)(d.G7,{className:"favorites",children:(0,v.jsxs)(d.G7,{className:"error-container",children:[(0,v.jsx)(d.xv,{className:"error-text",children:s}),(0,v.jsx)(d.zx,{className:"btn btn-primary",onClick:this.loadFavorites,children:"\u91cd\u65b0\u52a0\u8f7d"})]})}):(0,v.jsx)(d.G7,{className:"favorites",children:(0,v.jsx)(d.pf,{className:"favorites-scroll",scrollY:!0,enableBackToTop:!0,refresherEnabled:!0,refresherTriggered:a,onRefresherRefresh:this.onPullDownRefresh,children:(0,v.jsx)(d.G7,{className:"favorites-container",children:0===r.length?(0,v.jsxs)(d.G7,{className:"empty-state",children:[(0,v.jsx)(d.xv,{className:"empty-icon",children:"\u2764\ufe0f"}),(0,v.jsx)(d.xv,{className:"empty-text",children:"\u8fd8\u6ca1\u6709\u6536\u85cf\u4efb\u4f55\u5546\u54c1"}),(0,v.jsx)(d.xv,{className:"empty-hint",children:"\u53bb\u9996\u9875\u770b\u770b\u6709\u4ec0\u4e48\u597d\u8d27\u5427"}),(0,v.jsx)(d.zx,{className:"btn btn-primary mt-32",onClick:function(){return f().switchTab({url:"/pages/index/index"})},children:"\u53bb\u901b\u901b"})]}):r.map(function(n){return(0,v.jsxs)(d.G7,{className:"listing-card card",children:[(0,v.jsxs)(d.G7,{className:"listing-header",onClick:function(){return e.goToDetail(n.id)},children:[n.tags&&n.tags[0]&&(0,v.jsx)(d.G7,{className:"source-tag",children:n.tags[0]}),(0,v.jsx)(d.Ee,{className:"listing-image",src:n.images&&n.images[0]?n.images[0]:"https://picsum.photos/seed/crane/400/300",mode:"aspectFill",lazyLoad:!0})]}),(0,v.jsxs)(d.G7,{className:"listing-content",onClick:function(){return e.goToDetail(n.id)},children:[(0,v.jsx)(d.xv,{className:"listing-title",children:n.title}),(0,v.jsx)(d.G7,{className:"listing-tags",children:n.tags&&n.tags.slice(1).map(function(e,n){return(0,v.jsx)(d.xv,{className:"tag tag-gray",children:e},n)})}),(0,v.jsxs)(d.G7,{className:"listing-meta text-muted",children:[(0,v.jsxs)(d.xv,{className:"meta-item",children:[n.type," \xb7 ",n.brand," \xb7 ",n.tonnage,"\u5428"]}),(0,v.jsxs)(d.xv,{className:"meta-item",children:["\ud83d\udccd ",n.location," \xb7 ",n.post_date]})]})]}),(0,v.jsxs)(d.G7,{className:"listing-footer flex flex-between",children:[(0,v.jsx)(d.xv,{className:"price price-large",children:(0,g.T4)(n.price)}),(0,v.jsxs)(d.G7,{className:"listing-actions flex",children:[(0,v.jsx)(d.zx,{className:"btn btn-secondary btn-small",onClick:function(){return e.handleRemoveFavorite(n.id)},children:"\u53d6\u6d88\u6536\u85cf"}),(0,v.jsx)(d.zx,{className:"btn btn-primary btn-small",onClick:function(){return e.handleCall(n.phone)},children:"\u62e8\u6253\u7535\u8bdd"})]})]})]},n.id)})})})})}}])}(u.Component),j={navigationBarTitleText:"\u6211\u7684\u6536\u85cf",enablePullDownRefresh:!0};Page((0,a.createPageConfig)(p,"pages/favorites/favorites",{root:{cn:[]}},j||{}))}},function(e){var n=function(n){return e(e.s=n)};e.O(0,[107,216,592],function(){return n(3637)});e.O()}]);