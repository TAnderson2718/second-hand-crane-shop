"use strict";(wx["webpackJsonp"]=wx["webpackJsonp"]||[]).push([[539],{3550:function(e,s,t){var n=t(2180),a=t(298),r=t(8118),i=t(5308),l=t(2276),c=t(7042),o=t(4460),d=t(597),h=t(1867),u=t(5023),x=t(201),f=t(1515),m=t(2954),p=t.n(m),g=t(302),v=t(1876),j=t(2269),y=function(e){function s(){var e;(0,c.Z)(this,s);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=(0,d.Z)(this,s,[].concat(n)),(0,u.Z)(e,"state",{listings:[],filteredListings:[],showFilter:!1,loading:!1,filters:{province:"\u4e0d\u9650",city:"\u4e0d\u9650",type:"\u4e0d\u9650",brand:"\u4e0d\u9650",source:"\u4e0d\u9650",tonnage:"",emission:"\u4e0d\u9650",sortType:"\u53d1\u5e03\u65f6\u95f4-\u65b0\u5230\u65e7"},provinces:["\u4e0d\u9650"],cities:["\u4e0d\u9650"],types:["\u4e0d\u9650"],brands:["\u4e0d\u9650"],sources:["\u4e0d\u9650","\u8f66\u4e3b\u76f4\u5356","\u4e2d\u4ecb\u4fe1\u606f","\u4e8c\u624b\u8f66\u5546"],emissions:g.ES,sortTypes:["\u53d1\u5e03\u65f6\u95f4-\u65b0\u5230\u65e7","\u53d1\u5e03\u65f6\u95f4-\u65e7\u5230\u65b0","\u4ef7\u683c-\u4f4e\u5230\u9ad8","\u4ef7\u683c-\u9ad8\u5230\u4f4e"],provinceIndex:0,cityIndex:0,typeIndex:0,brandIndex:0,sourceIndex:0,emissionIndex:0,sortIndex:0}),(0,u.Z)(e,"initData",function(){var s=["\u4e0d\u9650"].concat((0,l.Z)(Object.keys(g.bY))),t=["\u4e0d\u9650"].concat((0,l.Z)(Object.keys(g.mj))),n=["\u4e0d\u9650"].concat((0,l.Z)(new Set(Object.values(g.mj).flatMap(function(e){return e.brands}))));e.setState({provinces:s,types:t,brands:n})}),(0,u.Z)(e,"loadListings",(0,i.Z)((0,r.Z)().m(function s(){var t,n,a;return(0,r.Z)().w(function(s){while(1)switch(s.p=s.n){case 0:return e.setState({loading:!0}),(0,v.QP)("\u52a0\u8f7d\u4e2d..."),s.p=1,s.n=2,(0,g.Y9)();case 2:t=s.v,n=(0,v.$s)(t,e.state.filters.sortType),e.setState({listings:n,filteredListings:n}),s.n=4;break;case 3:s.p=3,a=s.v,console.error("\u52a0\u8f7d\u5546\u54c1\u5931\u8d25:",a),(0,v.CF)("\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5","error");case 4:return s.p=4,e.setState({loading:!1}),(0,v.Zk)(),p().stopPullDownRefresh(),s.f(4);case 5:return s.a(2)}},s,null,[[1,3,4,5]])}))),(0,u.Z)(e,"applyFilters",(0,i.Z)((0,r.Z)().m(function s(){var t,n,a,i;return(0,r.Z)().w(function(s){while(1)switch(s.p=s.n){case 0:return t=e.state.filters,(0,v.QP)("\u7b5b\u9009\u4e2d..."),s.p=1,e.setState({loading:!0}),s.n=2,(0,g.Y9)(t);case 2:n=s.v,a=(0,v.$s)(n,t.sortType),e.setState({filteredListings:a,showFilter:!1,loading:!1}),(0,v.CF)("\u627e\u5230 ".concat(a.length," \u6761\u7ed3\u679c")),s.n=4;break;case 3:s.p=3,i=s.v,console.error("\u7b5b\u9009\u5931\u8d25:",i),e.setState({loading:!1}),(0,v.CF)("\u7b5b\u9009\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5","error");case 4:return s.p=4,(0,v.Zk)(),s.f(4);case 5:return s.a(2)}},s,null,[[1,3,4,5]])}))),(0,u.Z)(e,"resetFilters",function(){var s={province:"\u4e0d\u9650",city:"\u4e0d\u9650",type:"\u4e0d\u9650",brand:"\u4e0d\u9650",source:"\u4e0d\u9650",tonnage:"",emission:"\u4e0d\u9650",sortType:"\u53d1\u5e03\u65f6\u95f4-\u65b0\u5230\u65e7"};e.setState({filters:s,provinceIndex:0,cityIndex:0,typeIndex:0,brandIndex:0,sourceIndex:0,emissionIndex:0,sortIndex:0,cities:["\u4e0d\u9650"]}),e.loadListings()}),(0,u.Z)(e,"onProvinceChange",function(s){var t=s.detail.value,n=e.state.provinces[t],r="\u4e0d\u9650"===n?["\u4e0d\u9650"]:["\u4e0d\u9650"].concat((0,l.Z)(g.bY[n]));e.setState({provinceIndex:t,cityIndex:0,cities:r,filters:(0,a.Z)((0,a.Z)({},e.state.filters),{},{province:n,city:"\u4e0d\u9650"})})}),(0,u.Z)(e,"onCityChange",function(s){var t=s.detail.value,n=e.state.cities[t];e.setState({cityIndex:t,filters:(0,a.Z)((0,a.Z)({},e.state.filters),{},{city:n})})}),(0,u.Z)(e,"onTypeChange",function(s){var t=s.detail.value,n=e.state.types[t],r=g.mj[n],i=r?["\u4e0d\u9650"].concat((0,l.Z)(r.brands)):e.state.brands;e.setState({typeIndex:t,brandIndex:0,brands:i,filters:(0,a.Z)((0,a.Z)({},e.state.filters),{},{type:n,brand:"\u4e0d\u9650"})})}),(0,u.Z)(e,"onBrandChange",function(s){var t=s.detail.value,n=e.state.brands[t];e.setState({brandIndex:t,filters:(0,a.Z)((0,a.Z)({},e.state.filters),{},{brand:n})})}),(0,u.Z)(e,"onSourceChange",function(s){var t=s.detail.value,n=e.state.sources[t];e.setState({sourceIndex:t,filters:(0,a.Z)((0,a.Z)({},e.state.filters),{},{source:n})})}),(0,u.Z)(e,"onEmissionChange",function(s){var t=s.detail.value,n=e.state.emissions[t];e.setState({emissionIndex:t,filters:(0,a.Z)((0,a.Z)({},e.state.filters),{},{emission:n})})}),(0,u.Z)(e,"onSortChange",function(s){var t=s.detail.value,n=e.state.sortTypes[t];e.setState({sortIndex:t,filters:(0,a.Z)((0,a.Z)({},e.state.filters),{},{sortType:n})}),e.applyFilters()}),(0,u.Z)(e,"onTonnageChange",function(s){var t=s.detail.value;t&&isNaN(parseFloat(t))?(0,v.CF)("\u8bf7\u8f93\u5165\u6709\u6548\u7684\u6570\u5b57","error"):e.setState({filters:(0,a.Z)((0,a.Z)({},e.state.filters),{},{tonnage:t})})}),(0,u.Z)(e,"toggleFilter",function(){e.setState({showFilter:!e.state.showFilter})}),(0,u.Z)(e,"handleCall",function(){var e=(0,i.Z)((0,r.Z)().m(function e(s){var t;return(0,r.Z)().w(function(e){while(1)switch(e.p=e.n){case 0:if(s){e.n=1;break}return(0,v.CF)("\u8054\u7cfb\u7535\u8bdd\u4e0d\u53ef\u7528","error"),e.a(2);case 1:return e.p=1,e.n=2,(0,v.Pt)(s);case 2:e.n=4;break;case 3:e.p=3,t=e.v,console.error("\u62e8\u6253\u7535\u8bdd\u5931\u8d25:",t),(0,v.CF)("\u62e8\u6253\u7535\u8bdd\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5","error");case 4:return e.a(2)}},e,null,[[1,3]])}));return function(s){return e.apply(this,arguments)}}()),(0,u.Z)(e,"handleFavorite",function(){var s=(0,i.Z)((0,r.Z)().m(function s(t){var n;return(0,r.Z)().w(function(s){while(1)switch(s.n){case 0:if(t){s.n=1;break}return s.a(2);case 1:try{n=g.pj.includes(t),n?((0,g.zm)(t),(0,v.CF)("\u5df2\u53d6\u6d88\u6536\u85cf")):((0,g._p)(t),(0,v.CF)("\u6536\u85cf\u6210\u529f")),e.setState({})}catch(e){console.error("\u6536\u85cf\u64cd\u4f5c\u5931\u8d25:",e),(0,v.CF)("\u64cd\u4f5c\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5","error")}case 2:return s.a(2)}},s)}));return function(e){return s.apply(this,arguments)}}()),(0,u.Z)(e,"goToDetail",function(e){if(e)try{(0,v.T8)("/pages/detail/detail?id=".concat(e))}catch(e){console.error("\u9875\u9762\u8df3\u8f6c\u5931\u8d25:",e),(0,v.CF)("\u9875\u9762\u8df3\u8f6c\u5931\u8d25","error")}}),e}return(0,h.Z)(s,e),(0,o.Z)(s,[{key:"componentDidMount",value:function(){this.initData(),this.loadListings()}},{key:"onPullDownRefresh",value:function(){this.loadListings()}},{key:"onReachBottom",value:function(){console.log("\u5230\u8fbe\u5e95\u90e8\uff0c\u53ef\u4ee5\u52a0\u8f7d\u66f4\u591a\u6570\u636e")}},{key:"render",value:function(){var e=this,s=this.state,t=s.filteredListings,n=s.showFilter,a=s.loading,r=s.provinces,i=s.cities,l=s.types,c=s.brands,o=s.sources,d=s.emissions,h=s.sortTypes,u=s.provinceIndex,x=s.cityIndex,m=s.typeIndex,p=s.brandIndex,y=s.sourceIndex,N=s.emissionIndex,Z=s.sortIndex,b=s.filters;return(0,j.jsxs)(f.G7,{className:"index",children:[(0,j.jsxs)(f.G7,{className:"filter-section",children:[(0,j.jsxs)(f.G7,{className:"filter-toggle",onClick:this.toggleFilter,children:[(0,j.jsx)(f.xv,{className:"filter-text",children:n?"\u6536\u8d77\u7b5b\u9009":"\u5c55\u5f00\u7b5b\u9009"}),(0,j.jsx)(f.xv,{className:"filter-arrow ".concat(n?"up":""),children:"\u25bc"})]}),n&&(0,j.jsxs)(f.G7,{className:"filter-content",children:[(0,j.jsxs)(f.G7,{className:"filter-row",children:[(0,j.jsx)(f.xv,{className:"filter-label",children:"\u5730\u533a:"}),(0,j.jsx)(f.cW,{mode:"selector",range:r,value:u,onChange:this.onProvinceChange,className:"filter-picker",children:(0,j.jsx)(f.G7,{className:"picker-display",children:r[u]})}),(0,j.jsx)(f.cW,{mode:"selector",range:i,value:x,onChange:this.onCityChange,className:"filter-picker",children:(0,j.jsx)(f.G7,{className:"picker-display",children:i[x]})})]}),(0,j.jsxs)(f.G7,{className:"filter-row",children:[(0,j.jsx)(f.xv,{className:"filter-label",children:"\u6765\u6e90:"}),(0,j.jsx)(f.cW,{mode:"selector",range:o,value:y,onChange:this.onSourceChange,className:"filter-picker-full",children:(0,j.jsx)(f.G7,{className:"picker-display",children:o[y]})})]}),(0,j.jsxs)(f.G7,{className:"filter-row",children:[(0,j.jsx)(f.xv,{className:"filter-label",children:"\u7c7b\u578b:"}),(0,j.jsx)(f.cW,{mode:"selector",range:l,value:m,onChange:this.onTypeChange,className:"filter-picker-full",children:(0,j.jsx)(f.G7,{className:"picker-display",children:l[m]})})]}),(0,j.jsxs)(f.G7,{className:"filter-row",children:[(0,j.jsx)(f.xv,{className:"filter-label",children:"\u54c1\u724c:"}),(0,j.jsx)(f.cW,{mode:"selector",range:c,value:p,onChange:this.onBrandChange,className:"filter-picker-full",children:(0,j.jsx)(f.G7,{className:"picker-display",children:c[p]})})]}),(0,j.jsxs)(f.G7,{className:"filter-row",children:[(0,j.jsx)(f.xv,{className:"filter-label",children:"\u89c4\u683c:"}),(0,j.jsx)(f.II,{className:"filter-input",placeholder:"\u8bf7\u8f93\u5165\u89c4\u683c",value:b.tonnage,onInput:this.onTonnageChange})]}),(0,j.jsxs)(f.G7,{className:"filter-row",children:[(0,j.jsx)(f.xv,{className:"filter-label",children:"\u6392\u653e:"}),(0,j.jsx)(f.cW,{mode:"selector",range:d,value:N,onChange:this.onEmissionChange,className:"filter-picker-full",children:(0,j.jsx)(f.G7,{className:"picker-display",children:d[N]})})]}),(0,j.jsxs)(f.G7,{className:"filter-row",children:[(0,j.jsx)(f.xv,{className:"filter-label",children:"\u6392\u5e8f:"}),(0,j.jsx)(f.cW,{mode:"selector",range:h,value:Z,onChange:this.onSortChange,className:"filter-picker-full",children:(0,j.jsx)(f.G7,{className:"picker-display",children:h[Z]})})]}),(0,j.jsxs)(f.G7,{className:"filter-buttons",children:[(0,j.jsx)(f.zx,{className:"btn btn-secondary",onClick:this.resetFilters,children:"\u91cd\u7f6e"}),(0,j.jsx)(f.zx,{className:"btn btn-primary",onClick:this.applyFilters,children:"\u7b5b\u9009"})]})]})]}),(0,j.jsx)(f.pf,{className:"listings-scroll",scrollY:!0,enableBackToTop:!0,refresherEnabled:!0,refresherTriggered:a,onRefresherRefresh:this.onPullDownRefresh,children:(0,j.jsx)(f.G7,{className:"listings-container",children:0===t.length?(0,j.jsxs)(f.G7,{className:"empty-state",children:[(0,j.jsx)(f.xv,{className:"empty-icon",children:"\ud83d\udce6"}),(0,j.jsx)(f.xv,{className:"empty-text",children:"\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u8f66\u8f86"})]}):t.map(function(s){return(0,j.jsxs)(f.G7,{className:"listing-card card",children:[(0,j.jsxs)(f.G7,{className:"listing-header",onClick:function(){return e.goToDetail(s.id)},children:[s.tags&&s.tags[0]&&(0,j.jsx)(f.G7,{className:"source-tag",children:s.tags[0]}),(0,j.jsx)(f.Ee,{className:"listing-image image image-cover",src:s.images&&s.images[0]?s.images[0]:"https://picsum.photos/seed/crane/400/300",mode:"aspectFill",lazyLoad:!0})]}),(0,j.jsxs)(f.G7,{className:"listing-content",onClick:function(){return e.goToDetail(s.id)},children:[(0,j.jsx)(f.xv,{className:"listing-title",children:s.title}),(0,j.jsxs)(f.G7,{className:"listing-tags",children:[(0,j.jsx)(f.xv,{className:"tag tag-primary",children:s.type||"\u672a\u77e5"}),s.tags&&s.tags[2]&&(0,j.jsx)(f.xv,{className:"tag tag-primary",children:s.tags[2]})]}),(0,j.jsxs)(f.G7,{className:"listing-meta text-muted",children:[(0,j.jsxs)(f.xv,{className:"meta-item",children:["\u51fa\u5382\u65e5\u671f: ",s.manufacture_date||"\u672a\u77e5"]}),(0,j.jsxs)(f.xv,{className:"meta-item",children:["\u53d1\u5e03\u65f6\u95f4: ",s.post_date||"\u672a\u77e5"]}),(0,j.jsxs)(f.xv,{className:"meta-item",children:["\u6240\u5728\u5730\u533a: ",s.location||"\u672a\u77e5"]})]})]}),(0,j.jsxs)(f.G7,{className:"listing-footer flex flex-between",children:[(0,j.jsx)(f.xv,{className:"price price-large",children:(0,v.T4)(s.price)}),(0,j.jsxs)(f.G7,{className:"listing-actions flex",children:[(0,j.jsx)(f.zx,{className:"btn btn-small btn-secondary mr-16",onClick:function(){return e.handleFavorite(s.id)},children:g.pj&&g.pj.includes(s.id)?"\u5df2\u6536\u85cf":"\u6536\u85cf"}),(0,j.jsx)(f.zx,{className:"btn btn-small btn-primary",onClick:function(){return e.handleCall(s.phone)},children:"\u62e8\u6253\u7535\u8bdd"})]})]})]},s.id)})})})]})}}])}(x.Component),N={navigationBarTitleText:"\u4e8c\u624b\u540a\u8f66",enablePullDownRefresh:!0,onReachBottomDistance:50};Page((0,n.createPageConfig)(y,"pages/index/index",{root:{cn:[]}},N||{}))}},function(e){var s=function(s){return e(e.s=s)};e.O(0,[107,216,592],function(){return s(3550)});e.O()}]);