"use strict";(wx["webpackJsonp"]=wx["webpackJsonp"]||[]).push([[704],{7551:function(e,s,t){var n=t(2180),a=t(8118),o=t(5308),r=t(7042),l=t(4460),c=t(597),i=t(1867),d=t(5023),h=t(201),m=t(1515),x=t(2954),u=t.n(x),p=t(302),f=t(1876),g=t(2269),j=function(e){function s(){var e;(0,r.Z)(this,s);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return e=(0,c.Z)(this,s,[].concat(n)),(0,d.Z)(e,"state",{posts:[],loading:!0,error:null}),(0,d.Z)(e,"loadPosts",(0,o.Z)((0,a.Z)().m(function s(){var t;return(0,a.Z)().w(function(s){while(1)switch(s.n){case 0:try{e.setState({loading:!0,error:null}),t=(0,p.ww)(),e.setState({posts:t,loading:!1})}catch(s){console.error("\u52a0\u8f7d\u53d1\u5e03\u5217\u8868\u5931\u8d25:",s),e.setState({error:"\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5",loading:!1}),(0,f.CF)("\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5","error")}case 1:return s.a(2)}},s)}))),(0,d.Z)(e,"goToDetail",function(e){if(e)try{(0,f.T8)("/pages/detail/detail?id=".concat(e))}catch(e){console.error("\u9875\u9762\u8df3\u8f6c\u5931\u8d25:",e),(0,f.CF)("\u9875\u9762\u8df3\u8f6c\u5931\u8d25","error")}}),(0,d.Z)(e,"goToPost",function(){try{(0,f.MR)("/pages/post/post")}catch(e){console.error("\u9875\u9762\u8df3\u8f6c\u5931\u8d25:",e),(0,f.CF)("\u9875\u9762\u8df3\u8f6c\u5931\u8d25","error")}}),(0,d.Z)(e,"handleEdit",function(e){(0,f.CF)("\u7f16\u8f91\u529f\u80fd\u5f00\u53d1\u4e2d","none")}),(0,d.Z)(e,"handleDelete",function(e){(0,f.CF)("\u5220\u9664\u529f\u80fd\u5f00\u53d1\u4e2d","none")}),(0,d.Z)(e,"onPullDownRefresh",function(){e.loadPosts().finally(function(){u().stopPullDownRefresh()})}),e}return(0,i.Z)(s,e),(0,l.Z)(s,[{key:"componentDidMount",value:function(){this.loadPosts()}},{key:"componentDidShow",value:function(){this.loadPosts()}},{key:"render",value:function(){var e=this,s=this.state,t=s.posts,n=s.loading,a=s.error;return n?(0,g.jsx)(m.G7,{className:"posts",children:(0,g.jsx)(m.G7,{className:"loading-container",children:(0,g.jsx)(m.xv,{children:"\u52a0\u8f7d\u4e2d..."})})}):a?(0,g.jsx)(m.G7,{className:"posts",children:(0,g.jsxs)(m.G7,{className:"error-container",children:[(0,g.jsx)(m.xv,{className:"error-text",children:a}),(0,g.jsx)(m.zx,{className:"btn btn-primary",onClick:this.loadPosts,children:"\u91cd\u65b0\u52a0\u8f7d"})]})}):(0,g.jsxs)(m.G7,{className:"posts",children:[(0,g.jsx)(m.pf,{className:"posts-scroll",scrollY:!0,enableBackToTop:!0,refresherEnabled:!0,refresherTriggered:n,onRefresherRefresh:this.onPullDownRefresh,children:(0,g.jsx)(m.G7,{className:"posts-container",children:0===t.length?(0,g.jsxs)(m.G7,{className:"empty-state",children:[(0,g.jsx)(m.xv,{className:"empty-icon",children:"\ud83d\udcdd"}),(0,g.jsx)(m.xv,{className:"empty-text",children:"\u8fd8\u6ca1\u6709\u53d1\u5e03\u4efb\u4f55\u5546\u54c1"}),(0,g.jsx)(m.xv,{className:"empty-hint",children:"\u53d1\u5e03\u60a8\u7684\u7b2c\u4e00\u4e2a\u5546\u54c1\u5427"}),(0,g.jsx)(m.zx,{className:"btn btn-primary mt-32",onClick:this.goToPost,children:"\u53d1\u5e03\u5546\u54c1"})]}):t.map(function(s){return(0,g.jsxs)(m.G7,{className:"post-card card",children:[(0,g.jsxs)(m.G7,{className:"post-header",onClick:function(){return e.goToDetail(s.id)},children:[s.tags&&s.tags[0]&&(0,g.jsx)(m.G7,{className:"source-tag",children:s.tags[0]}),(0,g.jsx)(m.Ee,{className:"post-image",src:s.images&&s.images[0]?s.images[0]:"https://picsum.photos/seed/crane/400/300",mode:"aspectFill",lazyLoad:!0})]}),(0,g.jsxs)(m.G7,{className:"post-content",onClick:function(){return e.goToDetail(s.id)},children:[(0,g.jsx)(m.xv,{className:"post-title",children:s.title}),(0,g.jsx)(m.G7,{className:"post-tags",children:s.tags&&s.tags.slice(1).map(function(e,s){return(0,g.jsx)(m.xv,{className:"tag tag-gray",children:e},s)})}),(0,g.jsxs)(m.G7,{className:"post-meta text-muted",children:[(0,g.jsxs)(m.xv,{className:"meta-item",children:[s.type," \xb7 ",s.brand," \xb7 ",s.tonnage,"\u5428"]}),(0,g.jsxs)(m.xv,{className:"meta-item",children:["\ud83d\udccd ",s.location," \xb7 ",s.post_date]}),(0,g.jsxs)(m.xv,{className:"meta-item",children:["\u72b6\u6001: ","selling"===s.status?"\u5728\u552e":"\u5df2\u552e"]})]})]}),(0,g.jsxs)(m.G7,{className:"post-footer flex flex-between",children:[(0,g.jsx)(m.xv,{className:"price price-large",children:(0,f.T4)(s.price)}),(0,g.jsxs)(m.G7,{className:"post-actions flex",children:[(0,g.jsx)(m.zx,{className:"btn btn-secondary btn-small",onClick:function(){return e.handleEdit(s.id)},children:"\u7f16\u8f91"}),(0,g.jsx)(m.zx,{className:"btn btn-danger btn-small",onClick:function(){return e.handleDelete(s.id)},children:"\u5220\u9664"})]})]})]},s.id)})})}),(0,g.jsx)(m.G7,{className:"floating-action",children:(0,g.jsx)(m.zx,{className:"fab-button",onClick:this.goToPost,children:"+"})})]})}}])}(h.Component),N={navigationBarTitleText:"\u6211\u7684\u53d1\u5e03",enablePullDownRefresh:!0};Page((0,n.createPageConfig)(j,"pages/posts/posts",{root:{cn:[]}},N||{}))}},function(e){var s=function(s){return e(e.s=s)};e.O(0,[107,216,592],function(){return s(7551)});e.O()}]);